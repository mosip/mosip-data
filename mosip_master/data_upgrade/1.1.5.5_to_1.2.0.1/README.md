## Migrating country specific data from 1.1.5.5 to 1.2.0.1 version

Prerequisites:
-> SQL migration must be successfully executed.
-> Go to upgrade.properties file and modify the property values as per the environment.

Note: List of the commands executed during the data upgrade can be found in upgrade_commands.txt. One command per line. Commands using data-uploader.py script cannot be executed after it is successfully executed once. It should be commented for the next execution(upgrade.sh ignores the commented lines).


1. Migration of dynamic field table data.
	Dynamic value was stored as jsonarray in version 1.1.5*, now in 1.2.0.1 we store it as json object. one entry for each language of the field.

	Script takes the backup of existing table and migrates dynamic field table data into new table created.

2. UI Spec migration

	In 1.1.5* both Identity schema and UI spec was stored in identity_schema table. From 1.2.0 it is split into 2 different tables, identity_schema and ui_spec. As part of sql upgrade script data split is taken care.

	Here, we take care of migrating old UI spec to new UI spec.
	Ref: https://docs.mosip.io/1.2.0/modules/registration-client/registration-client-ui-specifications
	-> It is recommended to verify the validators and visibility expressions in migrated UI SPEC.
	-> After this migration, one old ui spec will be divided into 3 different ui spec like "newProcess", "updateProcess" and "lostProcess".
	-> AGEGROUP_CONFIG in the upgrade.properties should be updated with respect to agegroup defined in the environment with the property name "mosip.regproc.packet.classifier.tagging.agegroup.ranges" in registration-default.properties file. 


	Refer below API documentation to define and publish UI spec

	https://mosip.github.io/documentation/1.2.0/kernel-masterdata-service.html#operation/defineUISpec
	https://mosip.github.io/documentation/1.2.0/kernel-masterdata-service.html#operation/publishUISpec

3. Template type and Template data change: 
	
	New template types and templates were introduced in 1.2.0.1. All the new types and templates itself are provided in the xlsx file in the same directoy in english, arabic, french, kannada, hindi and tamil languages.

	1. "id" column in the templates excel sheet is autogenerated before upload to server.
	2. Make sure to remove unsupported languages from the excel files before starting the migration.
	3. Cross check if all the language specific data is valid and correct w.r.t the language.Make the change as required in the template text (file_text column) if required.

	Note: We have introduced "label" and "value" in registration client acknowledgment and preview templates. Data in all the captured languages are slash separated and is provided to the template with "label" and "value" keys. So instead of "primaryLabel" and "primaryValue", "secondaryLabel" and "secondaryValue" use "label" and "value". To be backward compatibile, we still provide support for "primaryLabel" and "primaryValue" in 1.2.0.1.

4. Machine Type, Machine Specification & Zone User mapping:

	Resident service is introduced as new machine type and corresponding machine specification is added.
	And most importantly, Resident service client is mapped to the top most zone in the zone heirarchy (country code).

	Note: In zone_user_delta.xlsx, resident service client is mapped to a dummy zone "MOR". Before execution of the upgrade.sh script, update the zone_code to appropriate value and save the changes.
